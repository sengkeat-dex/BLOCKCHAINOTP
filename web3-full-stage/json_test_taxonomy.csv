Layer,Area,Test Type,Key Assertions,Inputs / Fixtures,Primary Tools,Metrics,Failure Signal,Evidence Artifact,CI Gate / Policy,Severity
Security/Prevention,JSON Syntax,Parser rejects invalid tokens,No trailing commas; double quotes only; no comments; no NaN/Infinity/undefined; valid escapes; UTF-8 only,Malformed JSON snippets per 'Common Pitfalls' + 'String Escapes' combos,"jsonlint, jq --stream, Rust serde_json::from_str",0 schema-violating payloads merged; parse error rate == 0% in fixtures,HTTP 400 on parse errors; SyntaxError raised,CI logs of jsonlint runs + example inputs,Block merge if any invalid sample parses without error,Critical
Security/Prevention,Whitespace/Numbers,Strict number grammar,No leading zeros; IEEE-754 compatibility; exponent/float formats per spec,"Numbers like 01, -00.1, 6.022e23, 1e-10","serde_json, AJV num tests",All invalid numerics rejected; valid accepted,Incorrect acceptance of 01 or Infinity,Test report with accepted/denied cases,Fail build if any invalid numeric accepted,High
Security/Prevention,Encoding,UTF-8 enforcement,Reject invalid U+ sequences/BOM misuse; accept UTF-8; handle CR/LF consistently,"Files encoded with UTF-16, broken UTF-8, BOM/no-BOM variants","file -i, iconv checks, serde_json",0 non-UTF-8 payloads accepted,HTTP 400 + error label 'ENCODING',Ingress validation logs,Ingress rejects non-UTF-8,High
Testing/Validation,Type,Type conformance,Values match declared 'type' (object/array/string/number/integer/boolean/null),Schema with 'type' permutations; mixed payload set,"AJV, python jsonschema, jsonschema-rs",Type error count; coverage of all primitive/object types,422 Unprocessable with field/type message,"Validator error JSON (keyword, instancePath, message)",Fail if any payload passes with wrong type,High
Testing/Validation,Properties/Required,Required keys present,All listed in 'required' exist; 'additionalProperties' respected,"Schema: required [id,name,email]; additionalProperties=false","AJV, Spectral (OpenAPI)",Missing key detection rate 100%,"422 with details[field:'email', issue:'is required']",CI artifact: validator.errors JSON,Block if any sample with missing required passes,High
Testing/Validation,Items,Array item schema,Every element matches 'items' schema; nested arrays handled,Arrays of strings; arrays of objects with nested schemas,"AJV, jsonschema",Item violation count,422 item path errors (.users[3].email),Validator error dump,Fail if any item mismatch accepted,High
Testing/Validation,String Constraints,minLength/maxLength/pattern,"Lengths adhered; regex patterns enforced (IDs, slugs, ISO8601, email)","Emails, slugs, codes (^[A-Z]{3}-\d{4}$)",AJV with formats & patterns,Pattern coverage; false-accept rate,422 pattern violation,Pattern test matrix artifact,Fail on false-accept > 0,High
Testing/Validation,Number Bounds,minimum/maximum/exclusive*,Numeric bounds enforced; integers vs numbers separated,age >= 18; percentage ≤ 100,AJV numeric rules,Bound violations found,422 with bound message,Test vectors CSV,Fail if any out-of-bound accepted,High
Testing/Validation,Enum,Enumerated value check,Values ∈ enum; strict (case-sensitive),"status ∈ {active,inactive,pending}",AJV enum,Enum false-accept rate,422 enum violation,Validator output,Fail on any enum drift,High
Testing/Validation,Format,Semantic formats,"email, uuid, uri, ipv4, date-time enforced (where configured)",Format fixtures good/bad,"AJV with formats plugin, rfc3339 validator",Format violation rate,422 format violation,List of invalid samples rejected,Fail if invalid passes with format on,High
Testing/Validation,Compositional,allOf/anyOf/oneOf/not semantics,All/allOf must hold; exactly one for oneOf; anyOf ≥1; not forbids,Polymorphic payloads with tags,AJV discriminator/oneOf,Discriminator accuracy,422 with which branch failed,Branch coverage report,Fail if multi-branch ambiguity unhandled,High
Testing/Validation,$ref Resolution,Local & external refs,All $ref resolved; cycles handled; JSON Pointer correct,schemas/common.json#/definitions/Address,AJV with $ref resolver,0 unresolved refs,$ref resolution error,Schema bundle artifact,Block merge if unresolved refs,High
Testing/Validation,Defaults,No validation from 'default','default' does not auto-fill; server must set explicitly,Schemas with 'default' fields,AJV behavior confirmation,No implicit default mutation,Unexpected autofill detected,Validator config dump,Fail if defaults mutate inputs,High
Protection,HTTP Codes,400 vs 422 correctness,Syntax errors → 400; semantic/schema errors → 422,Broken JSON + valid JSON failing schema,"k6 HTTP tests, Postman collections",Correct code ratio 100%,Wrong status code returned,HTTP transcript (HAR),Block on code mismatch,High
Protection,Content-Type,Content-Type header enforced,Requests with Content-Type: application/json; charset=utf-8; responses set,Varied headers (missing/mismatched),"Postman/newman, k6",Header compliance %,415/400 when missing/invalid,Newman report,Fail if response lacks content-type,High
Protection,Size Limits,Max payload size,Reject oversized JSON; DoS protection,1MB+ payloads,"k6, envoy/nginx limits",Bytes rejected above threshold,413 Payload Too Large,Gateway logs,Gate on size limit setting,High
Security,JWT,JWT validity & claims,exp/nbf/aud/iss enforced; alg whitelist; clock skew tolerance,Valid/expired/early tokens; wrong aud; alg=none attempt,"jsonwebtoken/josekit, OPA",Token rejection rate for bad tokens,401/403 with reason; audit log,Signed test results + keys,Fail if 'none' accepted or exp ignored,Critical
Security,JWS,Signature verification,Detached/compact JSON; key rotation honored,Rotated keys K1→K2,jose libraries,Signature verification accuracy,Signature accepted with wrong key,KMS rotation logs,Fail if stale key accepted,Critical
Security,JWE,Encryption required where specified,Confidential endpoints require JWE; AES-GCM/JWE algs,Encrypted/unencrypted variants,josekit,Encryption coverage,Plaintext accepted on confidential route,Config + test proofs,Block merge if plaintext passes,High
Security,I-JSON,Interoperability constraints,No NaN/Infinity; UTF-8; limits on number range; no duplicate keys,"Payloads with NaN, dup keys",AJV i-json profile,I-JSON violation count,422 i-json violation,Validator logs,Fail on any I-JSON violation,High
Governance,SemVer,Schema/API SemVer policy,Only additive changes in minor; breaking only in major,v1→v1.1 optional property add; remove breaks,"Spectral rules, OpenAPI diff",Diff classified correctly,Breaking change flagged without major bump,OpenAPI diff report,Block breaking changes on minor/patch,High
Governance,Backward/Forward,Compat tests,New server accepts old clients; old server tolerates new optional fields,Golden request/response fixtures across versions,"schemathesis, contract testing (pact)",Compat pass rate,Compat failure between client/server,Version matrix report,Fail if back/forward compat < 100%,High
Testing,JSON5/JSONC,Reject non-JSON in JSON endpoints,"Comments, single quotes, trailing commas not accepted as standard JSON",JSON5/JSONC samples,"jsonlint, serde_json",0 non-JSON accepted,200 on JSON5 in JSON endpoint,Test run logs,Fail if JSON5 passes JSON endpoint,High
Testing,NDJSON,Streaming acceptance where declared,One-json-per-line; correct newline delimitation; back-pressure,NDJSON logs; mixed good/bad lines,fluent-bit ingestion tests,Line parse success %,Dropped/merged lines,Ingestion metrics,Warn if < 99% lines ingested,Medium
Testing,JSON Patch,RFC 6902 operations,add/replace/remove/move/copy/test semantics correct,Patch vectors with edge paths,jsonpatch/libjsonpatch,Patch success/failure as expected,State diverges from expected,Before/after snapshots,Block if patch deviates,High
Testing,Merge Patch,RFC 7386 behavior,null deletes field; merge semantics,Merge payloads with nulls,Server handler tests,Deletes happen only on null,Unexpected deletion,Snapshot of merged object,Fail if semantics wrong,High
Performance,Compression,Brotli/Zstd/Gzip negotiation,Server serves br/zstd when requested; identity fallback,Accept-Encoding variants,"k6, curl",Compression ratio; latency,No compression when offered; wrong header,Perf report (latency/size),Warn if compression disabled on large payloads,Medium
Performance,Binary JSON,CBOR/MessagePack interop,Round-trip equivalence with JSON model; smaller/faster as expected,Equivalent payloads across encodings,cbor2/msgpack libs,Round-trip %; size delta,Mismatch or data loss,Round-trip tests + size stats,Warn if round-trip < 100%,Medium
Protection,SSE,Text/event-stream formatting,Each event has 'data:' lines + blank line; reconnection semantics,SSE fixture server,Delivery reliability,Malformed event blocks,cURL transcripts,Fail on malformed SSE,Policy: All SSE endpoints validated in CI,High
Protection,WebSocket,JSON frames schema-checked,Inbound/outbound frames validated against schema,WS chat fixtures,Frame validation rate,Server accepts invalid frame,WS logs + validator errors,Fail if invalid WS frame accepted,Policy: WS frames must validate 100%,High
Detection & Response,Structured Logs,JSON log envelope,level/message/timestamp; trace_id/span_id; user_id optional; no PII leakage,Log lines from services,% lines with required keys; PII scan 0,Missing keys; PII detected,ELK/Splunk queries + redaction proof,Block on PII in logs,High,High
Detection & Response,Tracing,W3C Trace Context fields,traceparent injected and propagated in JSON,HTTP spans through services,otelcol tests,Propagation rate,Missing or malformed traceparent,Trace graph screenshot,Warn if propagation < 95%,Medium
Detection & Response,Metrics JSON,Metrics endpoints integrity,JSON metrics shape stable; keys documented,Metrics payloads,Schema change detection,Metric key drift,Schema snapshot,Warn on undocumented metric keys,Low,High
Testing,Unicode,Unicode correctness,Correct escaping; surrogate pairs; RTL samples,"Strings with diacritics, RTL markers","serde_json, ICU checks",Unicode round-trip,Mojibake or decode errors,Round-trip proof,Fail on decode errors,High
Testing,Locale Data,CLDR tags accepted,Language tags like en-US stored as strings,CLDR sample set,Acceptance %,Rejected valid tags,Test matrix,Warn on tag mismatch,Low,High
Security/Prevention,Large Integers,Safe integer policy,Integers > 2^53-1 represented as strings; reject silent truncation,IDs: '9007199254740993',app policy tests,0 silent precision loss,Wrongly parsed to float,Precision policy doc + tests,Fail on precision loss,High
Testing,Circular/Refs,No circular references in JSON,"Reject circular structures (client-side), or use IDs/$ref",Synthetic circulars in serializers,serializer tests,No crash/TypeError handled,Uncaught recursion errors,Error handling proof,Warn if client serializer crashes,Low
Governance,Codegen,quicktype/serde model drift,Generated types match schemas; CI checks,quicktype outputs vs schemars,Drift count,Compilation/serde errors,Diff artifacts,Block if drift detected,High,High
Governance,Mocks,json-server/WireMock parity,Mocks reflect real schema; Dredd contract tests pass,"db.json, wiremock stubs",Contract pass rate,Contract mismatch,Dredd reports,Fail if contract < 100%,High,High
