Layer,Category,Main Type,Subtype,Purpose,Components/Techniques,Examples,Attacks Mitigated / Failure Prevented,Where to Apply,Runtime Controls,CI/Automation Checks,Priority,Risk,Owner,SLA,Metrics,Evidence,Issue Template,Promotion Gate Mapping
Validation,Format & Structure,Primitive Types,String/Number/Bool,Ensure declared primitive type is respected with bounds/coercion rules.,Type assertions; schema validators; numeric min/max; boolean strict parsing,"age:int 0..150; price:decimal(10,2); is_active:boolean only true/false","Type confusion, overflow, logic bugs, DoS via extreme values",Client+Gateway+Server,Schema-aware decoders (serde),JSON-Schema/Zod/Ajv lint; unit/property tests for boundary values,High,High,Backend,24h,Type error rate; % invalid rejected at boundary,Schema files; test logs,bug/validation-primitive,gate: contract-tests:validate-schema
Validation,Format & Structure,Identifiers,UUID/ULID/KSUID,Accept only cryptographically strong identifiers with exact format.,Regex for UUIDv4; ULID parser; length & charset checks,user_id=550e8400-e29b-41d4-a716-446655440000,Parsing errors; IDOR facilitation via sequential IDs,Server,Strong types (uuid crate),Regex/static checks; sample-based fuzzing over IDs,High,Medium,Backend,48h,Invalid-ID attempt rate,Regex + parser unit tests,bug/validation-id,gate: api:object-ownership-checks
Validation,Format & Structure,Enumerations,Whitelists,Only allow values from a fixed allowlist (enums).,Enum types; match statements; OpenAPI enums,"role in {admin,user,viewer}",Unexpected code paths; privilege creep,Client+Server,Enum exhaustiveness checks,Spectral lint for enum; compile-time enum coverage,Medium,Medium,Backend,72h,Enum misuse rate,OpenAPI snapshot,bug/validation-enum,gate: api:spec-lint
Validation,Lengths & Cardinality,Min/Max/Required,Strings/Arrays,Limit sizes to prevent parser/heap abuse; enforce required fields.,len() bounds; max collection size; required flags,username 3..32 chars; tags <= 10,"DoS, buffer issues, unexpected nulls",Client+Server+Gateway,Gateway body size limits,Fuzz size tests; gateway config check,High,High,Platform,24h,Rejected oversize rate; p95 payload size,Gateway config; fuzz reports,bug/validation-length,gate: gateway:request-size-limit
Validation,Content Validation,Unicode/Normalization,NFKC/Confusables,Canonicalize and validate Unicode to block spoofing and control chars.,NFKC normalization; block bidi; confusables detector,Usernames disallow zero-width joiners; homoglyph checks,"Phishing, auth bypass via lookalikes",Server,Unicode normalizer,Unicode lint; snapshot tests with attacker strings,Medium,Medium,AppSec,5d,Rejected confusable rate,Normalizer config + test vectors,bug/validation-unicode,gate: static:unicode-lint
Validation,Transport-Level,Protocol Limits,JSON/XML/GraphQL,"Constrain decoder depth, width, and disable dangerous features.",Max depth=20; max fields; XML no DTD; GraphQL complexity limit,Billion-laughs XML; deeply nested JSON; GQL depth 100,"Parser DoS, XXE",Gateway+Server,Depth/complexity limiters,Static analysis for parser flags; e2e DoS tests,High,High,Platform,24h,Parser OOM incidents,Config snapshots; chaos test logs,bug/validation-protocol,gate: perf:dos-resilience
Validation,Numeric & Financial,Money,Precision/Range/Currency,Accept only correct fixed-point precision and valid currency codes.,Fixed-point decimals; bankers rounding; ISO-4217 allowlist,"amount: i128 scaled by 1e2; currency in {USD,EUR,...}","Rounding attacks, overflow/underflow",Server+DB,Strong types (rust_decimal),Property tests across ranges; OpenAPI schemas,High,High,Payments,24h,Precision error rate,Property test artifacts,bug/validation-money,gate: finance:precision-checks
Validation,Temporal,Time,Timestamps/Windows/Skew,Ensure timestamps are valid and within allowed windows; order checks.,Skew window ±5m; monotonic sequence; timezone parsing,iat within ±5m; start < end,"Replay, ordering bugs",Server,Monotonic clock + NTP,Replay tests; skew simulation,High,Medium,Backend,48h,Rejected skew %,Auth server logs,bug/validation-time,gate: security:replay-protection
Validation,Security Validation,Subject Binding,Auth Context,Bind request fields to authenticated subject/identity.,token.sub == body.user_id; mTLS identities,Update profile must match token.sub,"Spoofing, confused deputy, IDOR",Server,OPA/Rego policies,Policy unit tests; negative tests,High,High,Security,24h,Mismatch rate,Policy repo & audit logs,bug/validation-subject,gate: security:object-ownership
Validation,Security Validation,Rate & Frequency,Anti-automation,Enforce rates per identity/IP/device for sensitive flows.,Token bucket; sliding window; challenge after threshold,Max 5 password resets/hour/IP,"Credential stuffing, resource exhaustion",Gateway+Server,Rate-limiter + CAPTCHA,Load tests; abuse simulations,High,High,Platform,24h,429 ratio; peak TPS tolerated,Gateway limiter config,bug/validation-rate-limit,gate: security:abuse-defense
Validation,Content Validation,File Uploads,MIME/Size/Magic,"Validate true type via magic bytes, size limits; reject active content.",libmagic; image decoders; strip EXIF,JPEG only <=5MB; no macros,RCE via polyglots; storage abuse,Edge+Server,Quarantine + scan,AV scan in CI; upload tests,High,High,Platform,24h,Malware detection rate,Scanner logs,bug/validation-file,gate: storage:scan-required
Validation,API Contract,Schema Versioning,Version gates,Require explicit API version headers and compatible schemas.,Accept-Version; OpenAPI versioning; feature flags,vnd.app.v2,Breaking change misuse; undefined behavior,Gateway+Server,Strict header check,Contract tests; spectral lint,Medium,Medium,Platform,3d,% requests with correct version,OpenAPI diffs,task/validation-versioning,gate: api:spec-compat
Validation,Input Semantics,Cross-References,FK existence/ownership,Ensure referenced resources exist and are owned by caller.,"DB FK, cache lookups, ACL checks",order.user_id belongs to token.sub,BOLA/IDOR; data integrity issues,Server+DB,Row-level security,Integration tests with fixtures,High,High,Backend,48h,403 rate for invalid refs,DB constraint definitions,bug/validation-crossref,gate: db:fk-constraints
Validation,Booleans & Flags,Strict Booleans,No stringy truthiness,Reject 'true'/'false' strings unless strictly parsed to boolean.,Strict parsers; schema coercion rules,"is_admin must be boolean true, not ""true""",Logic bypass; privilege escalation,Server,Strict deserializers,Schema tests for booleans,High,Medium,Backend,48h,Boolean coercion error rate,Deserializer config,bug/validation-bool,gate: static:coercion-lint
Sanitization,Output Encoding,HTML,Contextual encoding,Escape special chars before inserting into HTML bodies.,"html-escape (<, >, &, "", ')",Render bio via text node,Reflected/stored XSS,Client+Server+Templates,CSP 'self'; no inline,Template engine default-escape enforced,High,High,Frontend,24h,XSS incidents = 0,CSP reports; code review,bug/sanitize-html,gate: ui:template-escape
Sanitization,Output Encoding,Attribute,Attribute context,Encode for attribute contexts; block event-handler attributes.,attr-escape; safe attribute allowlist,<img alt='...'> only,Attribute-based XSS,Templates,Template sanitizer,Static template lint,High,High,Frontend,24h,Blocked attribute rate,Template audits,bug/sanitize-attr,gate: ui:template-escape
Sanitization,Output Encoding,URL,URL component encoding,Percent-encode untrusted data in URLs and query parts.,encodeURIComponent; strict routing,/profile?user=...,"XSS, open redirect",Client+Server,Router helpers,ESLint rules; unit tests,High,High,Frontend,24h,% URLs built via helpers,Code search results,bug/sanitize-url,gate: ui:url-builder-only
Sanitization,Output Encoding,JavaScript,JS string/identifier,"Avoid dynamic JS; if embedding data, serialize safely.",JSON.stringify; safe script tags; no eval,var data = JSON.parse('...'),JS injection → XSS,Front-end build,CSP strict-dynamic,CSP eval checker,High,High,Frontend,24h,CSP violation rate,CSP report URIs,bug/sanitize-js,gate: ui:csp-required
Sanitization,Canonicalization,Unicode,Normalize then validate,Normalize input to canonical form before storage/render.,NFKC; trim; lowercase where needed,Usernames/emails canonicalized,Bypass via lookalikes/whitespace,Server,Normalizer middleware,Normalization unit tests,Medium,Medium,Backend,5d,Normalization coverage,Config & tests,task/sanitize-unicode,gate: static:unicode-lint
Sanitization,Content Stripping,HTML,Strip dangerous markup,Strip tags/attributes/styles; keep safe subset.,DOMPurify/Bleach; Markdown sanitizer,User comments,Stored XSS,Server,Sanitizer pipeline,Sanitizer unit tests,High,High,Backend,24h,Strip success rate,Sanitizer config snapshot,bug/sanitize-html-strip,gate: ui:richtext-sanitize
Sanitization,Content Stripping,Files,Metadata & active content,Remove EXIF/macros; flatten PDFs/images; re-encode images.,exiftool; pdfunite; re-encode JPEG/PNG,Avatar uploads,"Macro malware, privacy leaks",Upload pipeline,AV + sandbox,CI check for tools; sample scans,High,High,Platform,24h,Files with EXIF removed %,Scanner logs,bug/sanitize-file-meta,gate: storage:scan-required
Sanitization,SQL/NoSQL Safety,Query Building,Parameterized queries,Build queries with bind parameters; never string-concat.,Prepared statements; query builders; ORMs,db.query('... where id = $1'),SQL/NoSQL injection,Server+DB,DB least-privilege,SAST for string concat patterns,High,High,Backend,24h,Injection finding count,SAST reports; DB logs,bug/sanitize-db-params,gate: static:sqli-block
Sanitization,Path Safety,Filesystem,Path normalization,Resolve and enforce safe roots; deny traversal sequences.,path.resolve; chroot; jailed storage,uploads/user123/avatar.png,Path traversal,Server,Read-only FS where possible,Unit tests for traversal,High,High,Platform,24h,Traversal attempts blocked,Server logs,bug/sanitize-path,gate: storage:fs-sandbox
Sanitization,Command Safety,Shell,Argument escaping,Avoid shell; pass argv arrays; whitelist commands.,execve argv; shlex.quote; no eval/system(),ffmpeg with fixed args,Command injection → RCE,Server,Seccomp/AppArmor profiles,Semgrep rules for shell calls,High,High,Platform,24h,Shell call count; safe wrapper %,Code scans,bug/sanitize-shell,gate: runtime:seccomp-required
Sanitization,Deserialization,Parsers,Safe codecs,Use safe formats (JSON/CBOR); deny unsafe YAML/Pickle types.,YAML safe loader; type allowlist,"Config loaders, bots/agents",RCE via unsafe deserialization,Server/Agents,Policy to deny type tags,SAST for unsafe loaders,High,High,Backend,24h,Unsafe loader occurrences,Dependency audit,bug/sanitize-deser,gate: static:deser-policy
Sanitization,Logging & Redaction,PII/Secrets,Token/email masking,Redact secrets and PII before writing logs.,Regex redaction; field-level logging,xxxx-xxxx-xxxx-1234; Bearer ***,Secret leakage → lateral compromise,All services,Short retention for sensitive logs,Secret scanning in CI; log lint,High,High,Platform,24h,Secrets leaked = 0,CI scan artifacts,bug/sanitize-logs,gate: security:secret-scan
Sanitization,HTML Templating,CSP,Defense-in-depth,Restrictive CSP to reduce XSS blast radius.,script-src 'self' 'unsafe-inline'? no; object-src 'none',Block inline scripts,XSS impact reduction,Edge+Server,CSP report endpoint,Header tests; browser CSP reports,Medium,High,Security,48h,CSP violation rate,CSP report logs,task/csp-policy,gate: edge:headers-verified
Sanitization,Serialization Safety,Strict JSON,Drop unknown fields,Stable serializers; escape U+2028/2029; no prototype pollution.,Safe JSON writers; `additionalProperties: false`,API responses,XSSI/proto pollution,Server,Contract tests,OpenAPI conformance tests,Medium,Medium,Backend,3d,Unknown field drop rate,OpenAPI snapshots,task/json-strict,gate: api:contract-tests
Sanitization,Email/Chat,Rich Text,Safe Markdown,Render Markdown into a safe HTML subset only.,CommonMark → DOMPurify,User bios/comments/messages,Stored XSS via rich text,Server,SameSite cookies; HttpOnly,Golden tests on samples,Medium,Medium,Frontend,3d,Rendering diff rate,Renderer fixtures,bug/sanitize-markdown,gate: ui:richtext-sanitize
Sanitization,Storage Hygiene,Canonical at Rest,Normalized storage,"Store canonical sanitized forms (e.g., lowercased emails).",Lowercasing; trimming; Unicode NFKC for usernames,User records,Auth bypass via variants; duplicate accounts,DB,DB constraints/triggers,DB migration checks; constraints lint,Medium,Medium,Backend,5d,Mismatch before/after %,DDL + triggers,task/storage-canonical,gate: db:constraints
